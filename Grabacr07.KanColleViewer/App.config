<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <configSections>
        <sectionGroup name="applicationSettings" type="System.Configuration.ApplicationSettingsGroup, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
            <section name="Grabacr07.KanColleViewer.Properties.Settings" type="System.Configuration.ClientSettingsSection, System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
        </sectionGroup>
    </configSections>
    <startup> 
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
    </startup>
    <runtime>
      <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
        <probing privatePath="lib"/>
      </assemblyBinding>
    </runtime>
    <applicationSettings>
        <Grabacr07.KanColleViewer.Properties.Settings>
            <setting name="LocalProxyPort" serializeAs="String">
                <value>37564</value>
            </setting>
            <setting name="KanColleUrl" serializeAs="String">
                <value>http://www.dmm.com/netgame/social/application/-/detail/=/app_id=854854/</value>
            </setting>
            <setting name="OverrideStyleSheet" serializeAs="String">
                <value>body {
    margin:0;
    overflow:hidden;
}

#game_frame {
    position:fixed;
    left:50%;
    top:-16px;
    margin-left:-450px;
    z-index:1;
}

#flashWrap {
    position:fixed;
    z-index:1;
    margin:0;
}

#spacing_top, #sectionWrap {
    visibility: hidden !important;
    height:0 !important;
    display: none !important;
}</value>
            </setting>
            <setting name="UIContentHight" serializeAs="String">
                <value>333</value>
            </setting>
            <setting name="FeatureBrowserEmulation" serializeAs="String">
                <value>8000</value>
            </setting>
            <setting name="XMLTransUrl" serializeAs="String">
                <value>https://raw.github.com/Zharay/KanColleViewer/master/resources/translations/</value>
            </setting>
            <setting name="KCVUpdateUrl" serializeAs="String">
                <value>https://raw.github.com/Zharay/KanColleViewer/master/resources/Version.xml</value>
            </setting>
            <setting name="FlashQualityJS" serializeAs="String">
                <value>var flashQuality = function () {{
	try {{
    for (var objs = document.embeds, i = objs.length - 1; i &gt;= 0; i--) {{
        if (objs[i].getAttribute('quality') == '{0}') 
            continue;
        
        var embedElem = document.createElement('embed');
        var parentElem = objs[i].parentNode;
        
        for (var attrib = objs[i].attributes, j = attrib.length; j &gt;= 0; j--) {{
            if (attrib[j] != null) if (attrib[j].specified) {{
                embedElem.setAttribute(attrib[j].name, attrib[j].value);
            }}
        }}
        
        embedElem.setAttribute('quality', '{0}');
        embedElem.setAttribute('wmode', '{1}');
        
        parentElem.removeChild(objs[i]);
        parentElem.appendChild(embedElem);
    }}
    
    for (var objs = document.getElementsByTagName('object'), i = objs.length - 1; i &gt;= 0; i--) {{
        var embedElem = document.createElement('embed');
        var parentElem = objs[i].parentNode;
        
        for (var c = objs[i].childNodes, j = c.length - 1; j &gt;= 0; j--) {{
            embedElem.setAttribute(c[j].tagName, c[j].getAttribute('value'));
        }}
        
        embedElem.setAttribute('quality', '{0}');
        embedElem.setAttribute('wmode', '{1}');
        
        parentElem.removeChild(objs[i]);
        parentElem.appendChild(embedElem);
	}}
	}}
	catch(e) {{
	if ({2}) alert("Quality Settings Failed!\n"+e.message);
	}}
}};

var InjectTimeOut = 0;

var TimedInject = setInterval(function () {{
    CheckChange();
}}, 100);

function CheckChange() {{
    if (document.getElementById('flashWrap') {{
	    if document.getElementById('flashWrap').innerHTML.length &gt; 10) {{
            flashQuality();
            clearInterval(TimedInject);
		}}
		else {{
		    InjectTimeOut++;  
	    }}
    }}
	if (!document.getElementById('flashWrap') || InjectTimeOut &gt;= 100) {{
        clearInterval(TimedInject);
    }}
}}</value>
            </setting>
        </Grabacr07.KanColleViewer.Properties.Settings>
    </applicationSettings>
</configuration>
